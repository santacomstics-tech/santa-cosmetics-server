<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Santa Cosmetics - Productos</title>
  <link rel="stylesheet" href="css/estilos.css" />
  <style>
    /* Mantener el mismo estilo actual para modal-envio */
    #modal-envio {
      position: fixed;
      top: 0; left: 0;
      width: 100%; height: 100%;
      background: rgba(0,0,0,0.6);
      display: none; justify-content: center; align-items: center;
      z-index: 1000;
    }
    #modal-envio .modal-content {
      background: #fff;
      padding: 20px;
      border-radius: 12px;
      max-width: 420px;
      width: 92%;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }
    #modal-envio input, #modal-envio select {
      width: 100%;
      padding: 10px;
      margin-bottom: 8px;
      border: 1px solid #ccc;
      border-radius: 6px;
      box-sizing: border-box;
    }
    #modal-envio button {
      background-color: #c27ba0;
      color: white;
      border: none;
      padding: 10px;
      border-radius: 6px;
      width: 100%;
      cursor: pointer;
      font-size: 16px;
    }
    #modal-envio button:hover { background-color: #a75984; }

    /* Small helpers for tone swatches in tone modal */
    .paleta { display:flex; flex-wrap:wrap; gap:8px; }
    .tono-card { display:flex; align-items:center; gap:8px; padding:6px; border-radius:6px; cursor:pointer; border:1px solid #eee; }
    .tono-swatch { width:28px; height:28px; border-radius:4px; border:1px solid #ccc; }
    .tono-nombre { font-size:14px; }

    /* modal basic styles (tamano/tono/tipos) ‚Äî reuse existing UI */
    .modal { display:none; position:fixed; inset:0; align-items:center; justify-content:center; background: rgba(0,0,0,0.5); z-index:999; }
    .modal .modal-content { background:#fff; padding:18px; border-radius:10px; max-width:600px; width:92%; max-height:80vh; overflow:auto; }
    .option-btn { display:inline-block; margin:6px 6px 0 0; padding:8px 10px; border-radius:8px; border:1px solid #ddd; cursor:pointer; background:#fafafa; }
    .close-modal { float:right; background:transparent; border:none; font-size:16px; cursor:pointer; }
    .pago-overlay { display:none; position:fixed; inset:0; align-items:center; justify-content:center; background: rgba(0,0,0,0.5); z-index:1001; }
    .pago-box { background:#fff; padding:20px; border-radius:12px; text-align:center; min-width:240px; }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <h1 class="logo">Santa Cosmetics</h1>
      <nav class="main-nav">
        <a href="index.html">Inicio</a>
        <a href="productos.html" class="activo">Productos</a>
        <a href="https://www.facebook.com/santa.cosmetic.706367" target="_blank">Facebook</a>
        <a href="https://www.instagram.com/santacosmetic/" target="_blank">Instagram</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <h2>Nuestros Productos</h2>

    <div class="productos-grid">

      <!-- 1 Alisadora (sobre) -->
      <div class="card producto" data-selection="Ninguno" data-base="7300">
        <img src="img/alisadora en sobre.jpg" alt="Alisadora Mega Growth">
        <h4>Alisadora en Sobre Mega Growth</h4>
        <p class="precio">$7.300</p>
        <p class="descripcion">Sistema de alisado MegaGrowth con mezcla protectora de aceites naturales y prote√≠nas que mejora elasticidad y fortalece el cabello alisado. $7.300 por sobre.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 2 Cepillo Secador -->
      <div class="card producto" data-selection="Ninguno" data-base="55000">
        <img src="img/cepillo secador.jpg" alt="Cepillo Secador">
        <h4>Cepillo Secador Avocado 3D Power</h4>
        <p class="precio">$55.000</p>
        <p class="descripcion">√ösalo en cabello seco o h√∫medo. Cerdas mixtas, revestimiento cer√°mico, dise√±o ovalado, cable giratorio 360¬∞ y potencia 2000W.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 3 Gel Vibrante -->
      <div class="card producto" data-selection="Ninguno" data-base="4500">
        <img src="img/Gel vibrante .jpg" alt="Gel Vibrante Fawy">
        <h4>Gel Vibrante Fawy</h4>
        <p class="precio">$4.500</p>
        <p class="descripcion">Formulaci√≥n ideal para peinar, moldear y fijar tu cabello. Pote x130g $4.500 / Pote x370g $9.500.</p>
        <div class="botones-producto">
          <button class="btn primary tamano">Seleccionar tama√±o</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 4 Repolarizador -->
      <div class="card producto" data-selection="Ninguno" data-base="3300">
        <img src="img/Repolarizador capilar 8 en 1.jpg" alt="Repolarizador Capilar">
        <h4>Repolarizador Capilar 8 en 1</h4>
        <p class="precio">$3.300</p>
        <p class="descripcion">Multivitam√≠nico. Tres presentaciones: 300g $26.000 / 90g $8.600 / 30g $3.300.</p>
        <div class="botones-producto">
          <button class="btn primary tamano">Seleccionar tama√±o</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 5 Protector Solar -->
      <div class="card producto" data-selection="Ninguno" data-base="3800">
        <img src="img/protector_solar.jpg.jpg" alt="Protector Solar">
        <h4>Protector Solar en Sachet</h4>
        <p class="precio">$3.800</p>
        <p class="descripcion">Con color y sin color. Tono universal que se adapta a cualquier tipo y tono de piel. Textura ligera. No deja sensaci√≥n grasosa.</p>
        <div class="botones-producto">
          <button class="btn primary tono" data-paleta="protector">Seleccionar tono</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 6 Corrector L√≠quido -->
      <div class="card producto" data-selection="Ninguno" data-base="16000">
        <img src="img/corrector_liquido.jpg.jpg" alt="Corrector L√≠quido">
        <h4>Corrector L√≠quido #DulceBella</h4>
        <p class="precio">$16.000</p>
        <p class="descripcion">Alta cobertura - Efecto hidratado y luminoso.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 7 Corrector Alta Cobertura -->
      <div class="card producto" data-selection="Ninguno" data-base="20000">
        <img src="img/corrector_cobertura.jpg.jpg" alt="Corrector Alta Cobertura">
        <h4>Corrector Alta Cobertura</h4>
        <p class="precio">$20.000</p>
        <p class="descripcion">Corrector de cobertura media/alta con vitamina E y √°cido hialur√≥nico.</p>
        <div class="botones-producto">
          <button class="btn primary tamano">Seleccionar tama√±o</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 8 Tintura -->
      <div class="card producto" data-selection="Ninguno" data-base="5300">
        <img src="img/tintura_color1.jpg.jpg" alt="Tintura Color-1">
        <h4>Tintura Color-1</h4>
        <p class="precio">$5.300</p>
        <p class="descripcion">Tintura en crema Color-1. Presentaci√≥n en sobre y pote.</p>
        <div class="botones-producto">
          <button class="btn primary tamano">Seleccionar tama√±o</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 9 Pesta√±as -->
      <div class="card producto" data-selection="Ninguno" data-base="8000">
        <img src="img/pesta√±as.jpg" alt="Pesta√±as Nesura">
        <h4>Pesta√±as Nesura</h4>
        <p class="precio">$8.000</p>
        <p class="descripcion">Descubre las Pesta√±as Nesura con efecto volumen ruso. Tama√±os: 10mm / 12mm / 14mm / Mixtas.</p>
        <div class="botones-producto">
          <button class="btn primary tamano">Seleccionar tama√±o</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 10 Esmaltes -->
      <div class="card producto" data-selection="Ninguno" data-base="4800">
        <img src="img/esmalte para u√±as.jpg" alt="Esmaltes">
        <h4>Esmaltes para U√±as</h4>
        <p class="precio">$4.800</p>
        <p class="descripcion">Tenemos para Ti 150 tonos: escarchados, cremosos, nacarados, perlados y bases fortalecedoras con vitaminas y prote√≠nas.</p>
        <div class="botones-producto">
          <button class="btn primary tono" data-paleta="esmalte">Seleccionar tono</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 11 Skala -->
      <div class="card producto" data-selection="Ninguno" data-base="33500">
        <img src="img/skala.jpg.jpg" alt="Skala">
        <h4>Skala Capilar</h4>
        <p class="precio">$33.500</p>
        <p class="descripcion">Skala es una marca brasile√±a de cuidado personal que ofrece productos capilares veganos inspirados en ingredientes naturales.</p>
        <div class="botones-producto">
          <button class="btn primary tipos">Seleccionar tipos</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 12 T√≥nico (original) -->
      <div class="card producto" data-selection="Ninguno" data-base="42500">
        <img src="img/tonico_capilar.jpg.jpg" alt="T√≥nico Capilar">
        <h4>T√≥nico Capilar</h4>
        <p class="precio">$42.500</p>
        <p class="descripcion">T√≥nico capilar que ayuda a controlar la ca√≠da del cabello y promueve su crecimiento. Nutre y fortalece el cuero cabelludo.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 13 T√≥nico Crecepell -->
      <div class="card producto" data-selection="Ninguno" data-base="42500">
        <img src="img/Tonico capilar crecepell.jpg" alt="T√≥nico Crecepell">
        <h4>T√≥nico Capilar Crecepell Vitalher</h4>
        <p class="precio">$42.500</p>
        <p class="descripcion">Controla la ca√≠da y favorece el crecimiento del cabello. Elimina la caspa mientras nutre y fortalece el cuero cabelludo.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 14 Gorro Sat√≠n -->
      <div class="card producto" data-selection="Ninguno" data-base="8000">
        <img src="img/gorro_satin.jpg.jpg" alt="Gorro Satin">
        <h4>Gorro de Sat√≠n</h4>
        <p class="precio">$8.000</p>
        <p class="descripcion">Protege el pelo a la hora de dormir, cuidando la fricci√≥n con la almohada y conservando la hidrataci√≥n.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 15 Polvo Suelto -->
      <div class="card producto" data-selection="Ninguno" data-base="18800">
        <img src="img/polvo_suelto.jpg.jpg" alt="Polvo Suelto">
        <h4>Polvo Suelto con Extracto Natural</h4>
        <p class="precio">$18.800</p>
        <p class="descripcion">Con extracto de Germen de Trigo, Avena y Vitamina E. Reduce el brillo excesivo de la piel y fija el maquillaje para un acabado mate.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 16 Gel Limpiador Garnier -->
      <div class="card producto" data-selection="Ninguno" data-base="42000">
        <img src="img/Gel limpiador facial 150ml.jpg" alt="Gel Limpiador Garnier">
        <h4>Gel Limpiador Facial Garnier</h4>
        <p class="precio">$42.000</p>
        <p class="descripcion">Limpia profundamente impurezas y oleosidades. Producto no testeado en animales. Uso diario.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 17 Tinte Thyms -->
      <div class="card producto" data-selection="Ninguno" data-base="14500">
        <img src="img/tinte con amoniaco Thyms Coloring.jpg" alt="Tinte Thyms">
        <h4>Tinte con Amon√≠aco Thyms Coloring</h4>
        <p class="precio">$14.500</p>
        <p class="descripcion">Alta pigmentaci√≥n y duraci√≥n; f√≥rmula con √≥leos que hidratan y protegen el cuero cabelludo. Cubre 100% las canas.</p>
        <div class="botones-producto">
          <button class="btn primary tono" data-paleta="tinte-thyms">Seleccionar tono</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 18 Kit Facial -->
      <div class="card producto" data-selection="Ninguno" data-base="56900">
        <img src="img/kit facial de arroz.jpg" alt="Kit Facial">
        <h4>Kit Facial de Arroz</h4>
        <p class="precio">$56.900</p>
        <p class="descripcion">Contiene vitaminas y minerales que hidratan, suavizan y protegen la piel. Uso diario por la ma√±ana y noche.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 19 Cauterizador Molecular -->
      <div class="card producto" data-selection="Ninguno" data-base="18200">
        <img src="img/Cauterizador Molecular.jpg" alt="Cauterizador Molecular">
        <h4>Cauterizador Molecular Thyms</h4>
        <p class="precio">$18.200</p>
        <p class="descripcion">Acondiciona, nutre, fortalece, hidrata, da brillo y protecci√≥n UV. Antifrizz, sella cut√≠cula y puntas abiertas. POTE $18.200 / SACHET $3.000.</p>
        <div class="botones-producto">
          <button class="btn primary tamano">Seleccionar tama√±o</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 20 Cepillo Rizos Viral -->
      <div class="card producto" data-selection="Ninguno" data-base="21200">
        <img src="img/Cepillo rizos.jpg" alt="Cepillo Rizos Viral">
        <h4>Cepillo Rizos Viral Curly Lovers</h4>
        <p class="precio">$21.200</p>
        <p class="descripcion">Aliado perfecto para desenredar, definir y estilizar cabello rizado, minimizando el da√±o y mejorando la textura.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 21 Kit Cebolla y Biotina -->
      <div class="card producto" data-selection="Ninguno" data-base="55500">
        <img src="img/kit de shampoo.jpg" alt="Kit Cebolla y Biotina">
        <h4>Kit Capilar Cebolla & Biotina</h4>
        <p class="precio">$55.500</p>
        <p class="descripcion">Shampoo 425ml, Acondicionador 425ml, Aceite 55ml y Mascarilla 490gr. Estimula y fortalece el cabello.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 22 Labial L√≠quido Resist -->
      <div class="card producto" data-selection="Ninguno" data-base="23000">
        <img src="img/Labial liquido.jpg" alt="Labial L√≠quido Resist">
        <h4>Labial L√≠quido Resist Vogue</h4>
        <p class="precio">$23.000</p>
        <p class="descripcion">Acabado 100% mate, duraci√≥n hasta 14 horas, no transfiere y color intenso.</p>
        <div class="botones-producto">
          <button class="btn primary tono" data-paleta="Labial L√≠quido Resist Vogue">Seleccionar tono</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 23 Laca Fijadora -->
      <div class="card producto" data-selection="Ninguno" data-base="3300">
        <img src="img/Laca fijadora.jpg" alt="Laca Fijadora">
        <h4>Laca Fijadora Color-1</h4>
        <p class="precio">$3.300</p>
        <p class="descripcion">Fijaci√≥n extrafuerte, brillo natural. Presentaciones: POTE x30ml $3.300 / POTE x125ml $8.000 / POTE x255ml $14.800.</p>
        <div class="botones-producto">
          <button class="btn primary tamano">Seleccionar tama√±o</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 24 Lip Gloss Llavero -->
      <div class="card producto" data-selection="Ninguno" data-base="14000">
        <img src="img/Lip Gloss Llavero.jpg" alt="Lip Gloss Llavero">
        <h4>Lip Gloss Llavero Shiny</h4>
        <p class="precio">$14.000</p>
        <p class="descripcion">Llaveros con lip gloss integrado, pr√°cticos y decorativos para llevar en el bolso.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 25 Matizante Prokpil -->
      <div class="card producto" data-selection="Ninguno" data-base="30000">
        <img src="img/Matizante Prokpil.jpg" alt="Matizante Prokpil">
        <h4>Matizante Prokpil</h4>
        <p class="precio">$30.000</p>
        <p class="descripcion">Tratamiento para mantener color, reparar y proteger la fibra capilar. Disponible en tonos: Malva, Cobre, Negro, Platino, Cenizo, Beige, Rojo, Chocolate, Humo.</p>
        <div class="botones-producto">
          <button class="btn primary tono" data-paleta="matizante">Seleccionar tono</button>
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

      <!-- 26 Shampoo Control Caspa -->
      <div class="card producto" data-selection="Ninguno" data-base="22300">
        <img src="img/Shampoo control caspa.jpg" alt="Shampoo Control Caspa">
        <h4>Shampoo Control Caspa Bulboxil</h4>
        <p class="precio">$22.300</p>
        <p class="descripcion">Con Lim√≥n, Eucalipto y activos contra la caspa (piritionato de zinc / octopirox). Cabello fresco y movimiento.</p>
        <div class="botones-producto">
          <button class="btn primary agregar">Agregar</button>
          <button class="btn primary leer-mas">Leer m√°s</button>
        </div>
      </div>

    </div>
  </main>

  <!-- carrito -->
  <aside class="carrito-box" id="carrito">
    <h3>Tu carrito üõçÔ∏è</h3>
    <ul id="carrito-items"></ul>
    <p>Total: <span id="total">$0</span></p>
    <button id="pagar" class="btn primary">Pagar</button>
    <button id="vaciar" class="btn">Vaciar carrito</button>
  </aside>

  <div class="pago-overlay" id="pago-overlay" style="display:none;"></div>

  <!-- MODALES -->
  <div class="modal" id="modal-tamano">
    <div class="modal-content">
      <button class="close-modal" id="cerrarTamano">Cerrar</button>
      <h3>Selecciona tama√±o</h3>
      <div class="options" id="opciones-tamano"></div>
    </div>
  </div>

  <div class="modal" id="modal-tono">
    <div class="modal-content">
      <button class="close-modal" id="cerrarTono">Cerrar</button>
      <h3>Selecciona tono</h3>
      <div id="modal-tono-body"></div>
    </div>
  </div>

  <div class="modal" id="modal-tipos">
    <div class="modal-content">
      <button class="close-modal" id="cerrarTipos">Cerrar</button>
      <h3>Selecciona tipo Skala</h3>
      <div class="options" id="opciones-tipos">
        <button class="option-btn">Dona Skala</button>
        <button class="option-btn">Potao Shampoo</button>
        <button class="option-btn">Maionese Capilar</button>
        <button class="option-btn">Mais Cachos</button>
        <button class="option-btn">Babosa</button>
        <button class="option-btn">Divino Pot√£o</button>
        <button class="option-btn">Liso Desmaiado</button>
        <button class="option-btn">Amido de Milho</button>
        <button class="option-btn">Bomba de Vitaminas</button>
        <button class="option-btn">Maracuj√° y Patu√°</button>
      </div>
    </div>
  </div>

  <!-- Modal de direcci√≥n (igual estilo que pediste) -->
  <div id="modal-envio">
    <div class="modal-content">
      <h3>Datos de Env√≠o</h3>
      <input id="nombre" placeholder="Nombre completo" required>
      <input id="ciudad" placeholder="Ciudad" required>
      <input id="direccion" placeholder="Direcci√≥n" required>
      <input id="telefono" placeholder="Tel√©fono" required>
      <input id="email" type="email" placeholder="Correo electr√≥nico" required>
      <button id="confirmarEnvio">Confirmar Pedido</button>
    </div>
  </div>

<script>
/* ===============================
   FUNCIONALIDAD JS
   =============================== */

/* Datos de tonos y tama√±os (mismos que antes, puedes editar) */
const tonosList = {
  "Protector Solar en Sachet": [
    {name:"Con color", hex:"#e6b89c"},
    {name:"Sin color", hex:"#f2efe9"}
  ],
  "Esmaltes para U√±as": [
    {name:"Rojo Cl√°sico", hex:"#c21807"},
    {name:"Rosa Pastel", hex:"#f8b7d6"},
    {name:"Fucsia", hex:"#d63384"},
    {name:"Violeta", hex:"#7e3aa6"},
    {name:"Azul Cielo", hex:"#61a8ff"},
    {name:"Verde Menta", hex:"#9be7c4"},
    {name:"Dorado", hex:"#e6c56d"},
    {name:"Negro Brillante", hex:"#222"},
    {name:"Nude Claro", hex:"#f7e6df"}
  ],
  "Tinte con Amon√≠aco Thyms Coloring": [
    {name:"Negro Intenso", hex:"#1b1b1b"},
    {name:"Casta√±o Oscuro", hex:"#3b2b1a"},
    {name:"Casta√±o Claro", hex:"#704a1d"},
    {name:"Rubio Dorado", hex:"#f2d68c"},
    {name:"Rojo Cobrizo", hex:"#b03a1c"},
    {name:"Caoba", hex:"#80332a"}
  ],
  "Labial L√≠quido Resist Vogue": [
    {name:"Linda", hex:"#c2769a"},
    {name:"C√°lida", hex:"#c17a3c"},
    {name:"Poderosa", hex:"#a3252a"},
    {name:"Valiente", hex:"#b03a5a"},
    {name:"Natural", hex:"#e4a796"}
  ],
  "Matizante Prokpil": [
    {name:"Malva", hex:"#5b2b6d"},
    {name:"Cobre", hex:"#b35a1f"},
    {name:"Negro", hex:"#1b1b1b"},
    {name:"Platino", hex:"#a8a8a8"},
    {name:"Cenizo", hex:"#7a7f89"},
    {name:"Beige", hex:"#f0e0b0"},
    {name:"Rojo", hex:"#a81c1c"},
    {name:"Chocolate", hex:"#6b3b27"},
    {name:"Humo", hex:"#606060"}
  ]
};

const tamanosMap = {
  "Cauterizador Molecular Thyms": [["POTE", 18200], ["SACHET", 3000]],
  "Laca Fijadora Color-1": [["30ml", 3300], ["125ml", 8000], ["255ml", 14800]],
  "Gel Vibrante Fawy": [["Pote 130g", 4500], ["Pote 370g", 9500]],
  "Repolarizador Capilar 8 en 1": [["30g", 3300], ["90g", 8600], ["300g", 26000]],
  "Tintura Color-1": [["Sobre", 5300], ["Pote", 31700]],
  "Pesta√±as Nesura": [["10mm", 8000], ["12mm", 9000], ["14mm", 9000], ["Mixtas", 9000]],
  "Laca Fijadora Color-1": [["30ml", 3300], ["125ml", 8000], ["255ml", 14800]],
  "Corrector Alta Cobertura": [["Standard", 20000]]
};

/* Helpers */
function formatPrice(n){ return "$" + Number(n).toLocaleString(); }
function parsePriceFromText(t){ return parseInt(String(t).replace(/\D/g,'')) || 0; }

/* Estado del carrito */
let cart = []; // array de {name, price, selection}
const carritoItemsEl = document.getElementById("carrito-items");
const totalSpan = document.getElementById("total");

/* Render carrito */
function renderCart(){
  carritoItemsEl.innerHTML = "";
  let total = 0;
  cart.forEach(item=>{
    const li = document.createElement("li");
    li.textContent = `${item.name}${item.selection && item.selection !== "Ninguno" ? " ("+item.selection+")" : ""} - ${formatPrice(item.price)}`;
    carritoItemsEl.appendChild(li);
    total += item.price;
  });
  totalSpan.textContent = formatPrice(total);
}

/* A√±adir producto */
function addToCartObject(card){
  const name = card.querySelector("h4").textContent.trim();
  // price read from data-base (always numeric)
  const base = parseInt(card.getAttribute("data-base")) || 0;
  const selection = card.getAttribute("data-selection") || "Ninguno";
  cart.push({ name, price: base, selection });
  renderCart();
}

/* Delegaci√≥n de eventos para botones */
document.addEventListener("click", (e) => {
  // AGREGAR
  if(e.target.matches(".agregar")){
    const card = e.target.closest(".producto");
    addToCartObject(card);
    return;
  }

  // LEER MAS toggle
  if(e.target.matches(".leer-mas")){
    const btn = e.target;
    const desc = btn.closest(".producto").querySelector(".descripcion");
    if(!desc) return;
    if(desc.style.display === "block"){ desc.style.display = "none"; btn.textContent = "Leer m√°s"; }
    else { desc.style.display = "block"; btn.textContent = "Ocultar"; }
    return;
  }

  // TAMANO - abrir modal y poblar opciones
  if(e.target.matches(".tamano")){
    const card = e.target.closest(".producto");
    const nombre = card.querySelector("h4").textContent.trim();
    const lista = tamanosMap[nombre] || [];
    const opcionesTamano = document.getElementById("opciones-tamano");
    opcionesTamano.innerHTML = "";
    if(lista.length === 0){
      opcionesTamano.innerHTML = "<p>No hay presentaciones disponibles.</p>";
    } else {
      lista.forEach(([label, precio])=>{
        const b = document.createElement("button");
        b.className = "option-btn";
        b.textContent = `${label} ‚Äî ${formatPrice(precio)}`;
        b.addEventListener("click", ()=>{
          // actualizar precio visible y atributo data-base y data-selection
          card.setAttribute("data-selection", "Tama√±o: " + label);
          card.querySelector(".precio").textContent = formatPrice(precio);
          card.setAttribute("data-base", precio);
          document.getElementById("modal-tamano").style.display = "none";
        });
        opcionesTamano.appendChild(b);
      });
    }
    document.getElementById("modal-tamano").style.display = "flex";
    return;
  }

  // TONO - abrir modal y mostrar paleta seg√∫n data-paleta o nombre
  if(e.target.matches(".tono")){
    const card = e.target.closest(".producto");
    const nombre = card.querySelector("h4").textContent.trim();
    const paletaAttr = e.target.getAttribute("data-paleta");
    let tonos = [];
    if(paletaAttr === "esmalte") tonos = tonosList["Esmaltes para U√±as"];
    else if(paletaAttr === "protector") tonos = tonosList["Protector Solar en Sachet"];
    else if(paletaAttr === "tinte-thyms") tonos = tonosList["Tinte con Amon√≠aco Thyms Coloring"];
    else if(paletaAttr === "matizante") tonos = tonosList["Matizante Prokpil"];
    else if(paletaAttr === "Labial L√≠quido Resist Vogue" || nombre.includes("Labial") || paletaAttr === "Labial L√≠quido Resist Vogue") tonos = tonosList["Labial L√≠quido Resist Vogue"];
    else tonos = tonosList[nombre] || [];

    const body = document.getElementById("modal-tono-body");
    body.innerHTML = "";
    if(tonos.length === 0){
      body.innerHTML = "<p>No hay tonos disponibles para este producto.</p>";
    } else {
      const pal = document.createElement("div");
      pal.className = "paleta";
      tonos.forEach(t=>{
        const item = document.createElement("div");
        item.className = "tono-card";
        const sw = document.createElement("div");
        sw.className = "tono-swatch";
        sw.style.background = t.hex;
        const nm = document.createElement("div");
        nm.className = "tono-nombre";
        nm.textContent = t.name;
        item.appendChild(sw);
        item.appendChild(nm);
        item.addEventListener("click", ()=>{
          card.setAttribute("data-selection", "Tono: " + t.name);
          // keep price same, selection updated
          document.getElementById("modal-tono").style.display = "none";
        });
        pal.appendChild(item);
      });
      body.appendChild(pal);
    }
    document.getElementById("modal-tono").style.display = "flex";
    return;
  }

  // TIPOS SKALA
  if(e.target.matches(".tipos")){
    const card = e.target.closest(".producto");
    // show modal - actual selection happens when user clicks one of option-btns inside modal
    document.getElementById("modal-tipos").style.display = "flex";
    // store active card to set selection when user picks one
    window._activeTiposCard = card;
    return;
  }

  // opciones en modal-tipos (option-btn)
  if(e.target.matches("#opciones-tipos .option-btn")){
    const val = e.target.textContent.trim();
    const card = window._activeTiposCard;
    if(card){
      card.setAttribute("data-selection", "Tipo: " + val);
    }
    document.getElementById("modal-tipos").style.display = "none";
    window._activeTiposCard = null;
    return;
  }
});

/* CERRAR modales (botones) */
document.getElementById("cerrarTamano").addEventListener("click", ()=> document.getElementById("modal-tamano").style.display = "none");
document.getElementById("cerrarTono").addEventListener("click", ()=> document.getElementById("modal-tono").style.display = "none");
document.getElementById("cerrarTipos").addEventListener("click", ()=> document.getElementById("modal-tipos").style.display = "none");

/* Cerrar modales al clicar fuera */
window.addEventListener("click", function(e){
  const mt = document.getElementById("modal-tamano");
  const mto = document.getElementById("modal-tono");
  const mtip = document.getElementById("modal-tipos");
  if(e.target === mt) mt.style.display = "none";
  if(e.target === mto) mto.style.display = "none";
  if(e.target === mtip) mtip.style.display = "none";
});

/* Vaciar carrito */
document.getElementById("vaciar").addEventListener("click", ()=>{
  cart = [];
  renderCart();
});

/* Pagar -> abrir modal-envio */
document.getElementById("pagar").addEventListener("click", ()=>{
  if(cart.length === 0){ alert("Tu carrito est√° vac√≠o üõçÔ∏è"); return; }
  document.getElementById("modal-envio").style.display = "flex";
});

/* Confirmar datos y enviar al servidor */
document.getElementById("confirmarEnvio").addEventListener("click", async ()=>{
  const nombre = document.getElementById("nombre").value.trim();
  const ciudad = document.getElementById("ciudad").value.trim();
  const direccion = document.getElementById("direccion").value.trim();
  const telefono = document.getElementById("telefono").value.trim();
  const email = document.getElementById("email").value.trim();

  if(!nombre || !ciudad || !direccion || !telefono || !email) {
    alert("Por favor completa todos los campos.");
    return;
  }

  const items = cart.map(i => `${i.name}${i.selection && i.selection!=="Ninguno" ? " ("+i.selection+")" : ""} - ${formatPrice(i.price)}`);
  const total = cart.reduce((s,i)=>s + i.price, 0);

  const payload = {
    carrito: items,
    total,
    cliente: { nombre, ciudad, direccion, telefono, email }
  };

  try {
    const res = await fetch("http://localhost:3000/checkout", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(payload)
    });
    const json = await res.json();
    if(json.success){
      alert("‚úÖ Pedido enviado con √©xito. Pronto te contactaremos.");
      document.getElementById("modal-envio").style.display = "none";
      cart = [];
      renderCart();
      // opcional: redirigir a 'gracias.html' si existe
      // window.location.href = "gracias.html";
    } else {
      alert("‚ùå Error al procesar el pedido: " + (json.error || json.message || "Desconocido"));
    }
  } catch(err){
    console.error(err);
    alert("Error al conectar con el servidor. Revisa que server est√© corriendo en http://localhost:3000");
  }
});

/* Inicializacion: asegurar precios visibles desde data-base */
document.querySelectorAll(".producto").forEach(card=>{
  const base = parseInt(card.getAttribute("data-base"));
  const p = card.querySelector(".precio");
  if(!isNaN(base) && p) p.textContent = formatPrice(base);
});

/* Selecci√≥n de opciones dentro de modal-tipos (delegation safe) */
document.getElementById("opciones-tipos").addEventListener("click", function(e){
  if(e.target && e.target.matches(".option-btn")){
    const val = e.target.textContent.trim();
    const card = window._activeTiposCard;
    if(card){
      card.setAttribute("data-selection", "Tipo: " + val);
      alert("Tipo seleccionado: " + val);
    }
    document.getElementById("modal-tipos").style.display = "none";
    window._activeTiposCard = null;
  }
});
</script>
</body>
</html>
